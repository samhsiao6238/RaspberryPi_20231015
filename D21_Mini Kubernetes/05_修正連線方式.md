# 關於不同網段的互動

_要從本機（192.168.1.101）訪問 Kubernetes 集群（容器內部 IP 為 192.168.49.2），而不使用 SSH 端口轉發的方式，可以考慮以下兩種方法_


## 橋接網絡模式

_使用橋接網絡模式來配置 Docker，使得容器和主機在同一個網段內，這樣本機就可以直接訪問 Kubernetes 集群的 IP 地址_

1. 停止當前的 Minikube 集群。

    ```bash
    minikube stop && minikube delete
    ```

2. 配置 Docker 使用橋接網絡，編輯 Docker 的 `daemon.json` 文件，如果不存在，則創建它。

    ```bash
    sudo nano /etc/docker/daemon.json
    ```

3. 選定一個 IP，比如說 `192.168.1.5`，進行測試確認無響應。

    ```bash
    ping 192.168.1.5
    ```

4. 添加以下內容，這會將 Docker 的默認橋接網絡配置為 192.168.1.x 網段的一部分（請根據實際網絡配置調整）。

    ```json
    {
      "bip": "192.168.1.5/24"
    }
    ```


5. 重啟 Docker。

    ```bash
    sudo systemctl restart docker
    ```

6. 重新啟動 Minikube。

    ```bash
    minikube start --driver=docker
    ```

7. 在橋接網絡模式下，先查詢容器的 ID。

    ```bash
    docker ps
    ```

8. 使用容器 ID 查詢其 IP 地址。

    ```bash
    docker inspect -f '{{range .NetworkSettings.Networks}}{{.IPAddress}}{{end}}' <container_id>
    ```

## 配置靜態路由

_在本機上配置靜態路由，使其能夠通過樹莓派訪問 Kubernetes 集群_

1. 確保 Minikube 已經在樹莓派上運行。

    ```bash
    minikube start --driver=docker
    ```

2. 在本機上添加靜態路由：假設樹莓派的 IP 是 192.168.1.153，運行以下命令，這會添加一條路由規則，將所有發往 192.168.49.0/24 網段的流量通過 192.168.1.153（樹莓派）轉發。

    ```bash
    sudo route add -net 192.168.49.0/24 gw 192.168.1.153
    ```

